inside -> firewall {
  RULE(filter, INPUT, tcp, @INTNET@, :1023, @INTIP@, 515, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @INTIP@, 515, @INTNET@, :1023, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}

firewall -> inside {
  RULE(filter, OUTPUT, tcp, @INTIP@, :1023, @INTNET@, 515, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @INTNET@, 515, @INTIP@, :1023, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}

outside -> firewall {
  RULE(filter, INPUT, tcp, @EXTNET@, :1023, @EXTIP@, 515, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @EXTIP@, 515, @EXTNET@, :1023, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}

firewall -> outside {
  RULE(filter, OUTPUT, tcp, @EXTIP@, :1023, @EXTNET@, 515, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @EXTNET@, 515, @EXTIP@, :1023, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}

inside -> outside {
  RULE(filter, FORWARD, tcp, @INTNET@, :1023, @EXTNET@, 515, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @EXTNET@, 515, @INTNET@, :1023, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  MASQ-RULE(nat, POSTROUTING, tcp, @INTNET@, :1023, @EXTNET@, 515, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
}

outside -> inside {
  RULE(filter, FORWARD, tcp, @EXTNET@, :1023, @INTNET@, 515, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @INTNET@, 515, @INTNET@, :1023, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}
