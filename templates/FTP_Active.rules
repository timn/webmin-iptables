inside -> firewall {
  RULE(filter, INPUT, tcp, @INTNET@, 1024:, @INTIP@, 21, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @INTIP@, 21, @INTNET@, 1024:, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)

  RULE(filter, INPUT, tcp, @INTNET@, 1024:, @INTIP@, 20, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @INTIP@, 20, @INTNET@, 1024:, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> inside {
  RULE(filter, OUTPUT, tcp, @INTIP@, 1024:, @INTNET@, 21, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @INTNET@, 21, @INTIP@, 1024:, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)

  RULE(filter, OUTPUT, tcp, @INTIP@, 1024:, @INTNET@, 20, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @INTNET@, 20, @INTIP@, 1024:, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

outside -> firewall {
  RULE(filter, INPUT, tcp, @EXTNET@, 1024:, @EXTIP@, 21, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @EXTIP@, 21, @EXTNET@, 1024:, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)

  RULE(filter, INPUT, tcp, @EXTNET@, 1024:, @EXTIP@, 20, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @EXTIP@, 20, @EXTNET@, 1024:, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> outside {
  RULE(filter, OUTPUT, tcp, @EXTIP@, 1024:, @EXTNET@, 21, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @EXTNET@, 21, @EXTIP@, 1024:, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)

  RULE(filter, OUTPUT, tcp, @EXTIP@, 1024:, @EXTNET@, 20, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, tcp, @EXTNET@, 20, @EXTIP@, 1024:, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

inside -> outside {
  KERNELMOD(modprobe, ip_conntrack_ftp)
  KERNELMOD(modprobe, ip_nat_ftp)
  RULE(filter, FORWARD, tcp, @INTNET@, 1024:, @EXTNET@, 21, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @EXTNET@, 21, @INTNET@, 1024:, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  MASQ-RULE(nat, POSTROUTING, tcp, @INTNET@, 1024:, @EXTNET@, 21, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
  RULE(filter, FORWARD, tcp, @INTNET@, 1024:, @EXTNET@, 20, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @EXTNET@, 20, @INTNET@, 1024:, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  MASQ-RULE(nat, POSTROUTING, tcp, @INTNET@, 1024:, @EXTNET@, 20, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
}

outside -> inside {
  RULE(filter, FORWARD, tcp, @EXTNET@, 1024:, @INTNET@, 21, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @INTNET@, 21, @INTNET@, 1024:, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)

  RULE(filter, FORWARD, tcp, @EXTNET@, 1024:, @INTNET@, 20, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
  RULE(filter, FORWARD, tcp, @INTNET@, 20, @INTNET@, 1024:, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}
