inside -> firewall {
  RULE(filter, INPUT, udp, @INTNET@, 1024:, @INTIP@, 161, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, udp, @INTIP@, 161, @INTNET@, 1024:, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, udp, @INTIP@, 1024:, @INTNET@, 162, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> inside {
  RULE(filter, OUTPUT, udp, @INTIP@, 1024:, @INTNET@, 161, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, udp, @INTNET@, 161, @INTIP@, 1024:, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, udp, @INTNET@, 1024:, @INTIP@, 162, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

outside -> firewall {
  RULE(filter, INPUT, udp, @EXTNET@, 1024:, @EXTIP@, 161, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, udp, @EXTIP@, 161, @EXTNET@, 1024:, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, udp, @EXTIP@, 1024:, @EXTNET@, 162, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> outside {
  RULE(filter, OUTPUT, udp, @EXTIP@, 1024:, @EXTNET@, 161, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, udp, @EXTNET@, 161, @EXTIP@, 1024:, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, udp, @EXTNET@, 1024:, @EXTIP@, 162, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

inside -> outside {
  RULE(filter, FORWARD, udp, @INTNET@, 1024:, @EXTNET@, 161, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, udp, @EXTNET@, 161, @INTNET@, 1024:, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  MASQ-RULE(nat, POSTROUTING, udp, @INTNET@, 1024:, @EXTNET@, 161, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
  RULE(filter, FORWARD, udp, @EXTNET@, 1024:, @INTNET@, 162, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

outside -> inside {
  RULE(filter, FORWARD, udp, @EXTNET@, 1024:, @INTNET@, 161, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, udp, @INTNET@, 161, @INTNET@, 1024:, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, udp, @INTNET@, 1024:, @INTNET@, 162, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}
