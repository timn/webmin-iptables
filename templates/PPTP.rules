outside -> firewall {
  RULE(filter, INPUT, tcp, @EXTNET@, 1024:, @EXTIP@, 1723, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, tcp, @EXTIP@, 1723, @EXTNET@, 1024:, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)

  RULE(filter, INPUT, gre, @EXTNET@, IGNORE, @EXTIP@, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, gre, @EXTIP@, IGNORE, @EXTNET@, IGNORE, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NO, ACCEPT, YES)
}

inside -> outside {
  MASQ-RULE(nat, POSTROUTING, gre, @EXTIP@, IGNORE, @INTNET@, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, NEW:RELATED:ESTABLISHED, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
}
