inside -> firewall {
  RULE(filter, INPUT, icmp, @INTNET@, IGNORE, @INTIP@, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, icmp, @INTIP@, IGNORE, @INTNET@, IGNORE, IGNORE, @INTDEV@, IGNORE, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> inside {
  RULE(filter, OUTPUT, icmp, @INTIP@, IGNORE, @INTNET@, IGNORE, IGNORE, @INTDEV@, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, icmp, @INTNET@, IGNORE, @INTIP@, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

outside -> firewall {
  RULE(filter, INPUT, icmp, @EXTNET@, IGNORE, @EXTIP@, IGNORE, @EXTDEV@, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, OUTPUT, icmp, @EXTIP@, IGNORE, @EXTNET@, IGNORE, IGNORE, @EXTDEV@, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

firewall -> outside {
  RULE(filter, OUTPUT, icmp, @EXTIP@, IGNORE, @EXTNET@, IGNORE, IGNORE, @EXTDEV@, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, INPUT, icmp, @EXTNET@, IGNORE, @EXTIP@, IGNORE, @EXTDEV@, IGNORE, IGNORE, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}

inside -> outside {
  RULE(filter, FORWARD, icmp, @INTNET@, IGNORE, @EXTNET@, IGNORE, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, icmp, @EXTNET@, IGNORE, @INTNET@, IGNORE, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  MASQ-RULE(nat, POSTROUTING, icmp, @INTNET@, IGNORE, @EXTNET@, IGNORE, @INTDEV@, IGNORE, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, MASQUERADE, YES)
}

outside -> inside {
  RULE(filter, FORWARD, icmp, @EXTNET@, IGNORE, @INTNET@, IGNORE, @EXTDEV@, @INTDEV@, IGNORE, IGNORE, echo-request, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
  RULE(filter, FORWARD, icmp, @INTNET@, IGNORE, @INTNET@, IGNORE, @INTDEV@, @EXTDEV@, IGNORE, IGNORE, echo-reply, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, IGNORE, ACCEPT, YES)
}
